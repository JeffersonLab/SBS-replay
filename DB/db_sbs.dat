-------[ 2021-01-01 00:00:00 ]


## track constraint widths:
sbs.frontconstraintwidth_x = 0.75 # m
sbs.frontconstraintwidth_y = 0.25 # m
sbs.backconstraintwidth_x = 0.28 # m
sbs.backconstraintwidth_y = 0.23 # m
sbs.backconstraint_x0 = 0.5 
sbs.backconstraint_y0 = -0.0042
sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = 0.0

sbs.gemorigin_xyz = 0.0 0.0 4.825

#the optics matrix elements below are for SBS 100% field setting (using approximation of uniform field in the magnet gap):
sbs.precon_flag = 0

sbs.optics_order = 2

# SBS 50% field for GEN configuration:
sbs.optics_parameters =
 -4.7492373e-05 -3.0076826e-05  9.7658771e-05      0.2368548  0 0 0 0 0
     0.29406313  -0.0022728891   0.0074340655   0.0016531116  1 0 0 0 0
 -0.00079535663   0.0034732323  -0.0087346869   0.0070309193  2 0 0 0 0
   0.0013825575  -0.0060321865      1.0274256  -0.0051965265  0 1 0 0 0
     0.11963484    0.026855614    -0.12483853    0.018499472  1 1 0 0 0
  -0.0054083514     0.05759505    -0.19453195    0.059565112  0 2 0 0 0
     -0.4195945    0.010480438   -0.035369236  -0.0098816328  0 0 1 0 0
    0.010900296   -0.030027456     0.08358603   -0.014998565  1 0 1 0 0
    -0.14793145    -0.12402843     0.58081927    -0.08525447  0 1 1 0 0
   -0.034567836     0.06354853    -0.19160053    0.044249134  0 0 2 0 0
  -0.0055976765      1.0273391     -4.9440968     0.01696626  0 0 0 1 0
    -0.58097842    -0.11795225     0.51742424   -0.061321435  1 0 0 1 0
    0.053480872     -0.4504135      1.5539073     -0.4541342  0 1 0 1 0
      0.7499874     0.61478662     -2.6543871     0.27831895  0 0 1 1 0
    -0.12665448     0.91037838      -3.197888     0.93866798  0 0 0 2 0
  5.3330367e-15  2.8911089e-14 -1.0816528e-13 -1.9194737e-14  0 0 0 0 1
 -1.9401887e-15 -4.1937965e-15  1.7721383e-14 -2.1850874e-14  1 0 0 0 1
  1.0722579e-15  7.7445726e-16 -3.7688536e-15  2.6770205e-15  0 1 0 0 1
  7.5106687e-16 -1.1950822e-15  9.8391957e-15 -1.2347115e-15  0 0 1 0 1
  2.3646997e-16 -1.1667667e-16 -1.9264282e-16 -5.6474397e-16  0 0 0 1 1
  3.2742694e-16  -1.094353e-15  3.2631097e-15  -1.518398e-15  0 0 0 0 2

# SBS 30% field for GEN configuration:
sbs.optics_parameters = 
 -3.9793076e-05 -0.00021958306  0.00077632912     0.14539652  0 0 0 0 0
     0.29362296 -0.00040166393   0.0022051916   0.0073454874  1 0 0 0 0
  0.00054633448  0.00089942297   0.0023068647  -0.0054110009  2 0 0 0 0
 -0.00025350036  -0.0047118895      1.0244949 -0.00045551193  0 1 0 0 0
     0.12749638    0.032892231    -0.16313876  -0.0014421081  1 1 0 0 0
   0.0033025146    0.051561798    -0.20332191    0.051639733  0 2 0 0 0
    -0.41796005   0.0020721824   -0.013641984   -0.035952964  0 0 1 0 0
   0.0031019379  -0.0094061969  -0.0049763021     0.07858849  1 0 1 0 0
    -0.18241576    -0.16207846     0.81647553    0.026106389  0 1 1 0 0
   -0.024779755    0.019820787   -0.014255702    -0.17153092  0 0 2 0 0
  0.00090686829      1.0195593     -4.9255022   -0.002373647  0 0 0 1 0
    -0.61557426    -0.13473266     0.65092994    0.021849731  1 0 0 1 0
   -0.024288308    -0.40223151      1.6266844    -0.41666754  0 1 0 1 0
     0.90072772     0.71085083     -3.4025141    -0.18276902  0 0 1 1 0
    0.035062243     0.80870167     -3.3436212     0.80097896  0 0 0 2 0
 -1.3192296e-14  3.4895072e-15 -2.3328211e-14 -2.3491218e-14  0 0 0 0 1
 -1.3821117e-15 -3.4791546e-15  1.1404732e-14  6.1396022e-15  1 0 0 0 1
  2.1336319e-15  2.9729321e-16 -1.0681814e-15 -2.6072193e-15  0 1 0 0 1
  1.5618654e-15   -9.90699e-16  4.0941642e-15 -4.1829097e-16  0 0 1 0 1
  5.1697134e-16  1.2310463e-16 -8.6493022e-16 -5.9245231e-16  0 0 0 1 1
  4.5944684e-16  6.6524697e-17  2.8352903e-16 -9.1314535e-16  0 0 0 0 2

--------[ 2022-10-14 00:00:00 ] # start GEN-2 kinematics: here we mainly run with SBS at full field:


# SBS 100% field for GEN configuration... BdL ~= 1.58 T*m
sbs.optics_parameters =
  -0.0003513201  5.3757169e-05 -0.00039405534      0.4746328  0 0 0 0 0
     0.29431137 -6.4786094e-05   0.0007172775    0.001446896  1 0 0 0 0
  0.00046508419 -0.00040215314   0.0014340977   0.0076777109  2 0 0 0 0
  0.00039824129  -0.0014993516       1.005907 -0.00018809634  0 1 0 0 0
     0.12583597   0.0093546922   -0.038057985   0.0032724021  1 1 0 0 0
   0.0050509875   0.0047190471   0.0093248106    0.038019853  0 2 0 0 0
    -0.42294892  0.00081299015  -0.0056427729  -0.0091939953  0 0 1 0 0
   0.0063149389   0.0020891526  -0.0060265101   0.0030162675  1 0 1 0 0
    -0.17285935   -0.040700375     0.16129629   -0.012315548  0 1 1 0 0
   -0.039082297    -0.00128007   -0.001709668    0.045100546  0 0 2 0 0
  -0.0040627701      1.0170874     -4.8926068   -0.002228922  0 0 0 1 0
    -0.59575772   -0.049546309     0.21091191  -0.0056070761  1 0 0 1 0
   -0.025402411   -0.037685667   -0.035912365    -0.21797913  0 1 0 1 0
     0.81142079     0.33997576     -1.3319419    0.029927015  0 0 1 1 0
    0.025431516    0.067446723    0.028925304     0.33807591  0 0 0 2 0
 -7.2130705e-16   2.395829e-15 -6.7074436e-16  2.8011489e-14  0 0 0 0 1
 -8.0344008e-16 -8.4204583e-15  4.6113261e-14 -7.7975922e-15  1 0 0 0 1
 -2.1963046e-16 -7.8606246e-16  2.4646817e-15 -1.0909688e-14  0 1 0 0 1
 -3.7147256e-16 -8.8648438e-16  6.0221692e-15  1.3425275e-14  0 0 1 0 1
 -3.3139766e-16 -5.5967834e-17 -3.8427815e-16 -9.6972098e-15  0 0 0 1 1
 -2.4792623e-16  2.7226815e-16 -1.3185506e-15 -8.6599971e-16  0 0 0 0 2


-------[ 2023-03-08 00:00:00 ] New Constraints for GEN4 kinematic

sbs.frontconstraintwidth_x = 1.0 # m
sbs.frontconstraintwidth_y = 0.3 # m

------[ 2023-09-01 00:00:00 ] # reverting to old constraint centering: 

sbs.frontconstraintwidth_x = 1.0 # m
sbs.frontconstraintwidth_y = 0.3 # m

sbs.backconstraintwidth_x = 0.22 # m
sbs.backconstraintwidth_y = 0.21 # m
sbs.backconstraint_x0 = 0.50286
sbs.backconstraint_y0 = 0.11554
sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = 0.0

-------[ 2023-11-01 00:00:00 ] # start pion-A_LL

sbs.backconstraint_x0 = 0.24
sbs.backconstraint_y0 = 0.0
sbs.backconstraintwidth_x = 0.25
sbs.backconstraintwidth_y = 0.22

-------[ 2024-04-01 00:00:00 ] # start GEN-RP

# according to the version of g4sbs used to generate this optics model, the first GEM plane is at 4.105 m
# from the target
sbs.optics_origin = 0.0 0.0 4.105 

# according to anecdotal, low-accuracy tape measurements from Sean and Anu and Bhashita et al,
# the GEN-RP GEM first layer was about 81 cm downstream of the back end of the SBS magnet iron in GEN,
# and in GEN-RP the first XW layer is about 5 cm downstream of THAT.
# so we estimate that the actual first GEN-RP GEM layer in Hall A is about 4.33 m from the target
# this is probably not a great guess! But anyway,
# for an initial guess at the ACTUAL position of the SBS GEMs in the hall, we go with:
#sbs.gemorigin_xyz = 0.0 0.0 4.329
#sbs.gemtheta = 0.0
#sbs.gemphi = 0.0

# AJRP 4/17/2024: Let's update these numbers from the survey report: according to the survey, the CE polarimeter fiducial point is
# 2.64 mm to beam left, 6.35 mm high, and 4.6 mm DOWNSTREAM of the "ideal" position which I assume is (0,0,4.760 m).
# assuming X/W layer 0,1 readout boards are symmetrically offset wrt the railing mount and 5.7 cm apart, then
# the first layer is essentially 0.428 m upstream of the fiducial point, which puts it at about 4.324 m 
# But wait! according to the survey, the magnet itself is also about 6.2 mm high and about 1.7 mm to beam left and about 1.2 mm upstream of ideal! so in fact,
# relative to the ideal optics coordinate system, the detector active area center is something like the following (to within a mm or so, not accounting for
# any mispointing or anything like that.
#sbs.gemorigin_xyz = 0.0 0.0 4.324
#sbs.gemtheta = 0.0
#sbs.gemphi = 0.0

# new GEM origin coordinates based on straight-through alignment, run 121:
# angles are given in degrees and positions in meters
#sbs.gemorigin_xyz =  -0.00644053   0.00102861      4.10979
#sbs.gemangles_xyz =     0.132415    -0.222712    -0.803711

# even better alignment after cutting the pathological region of track X
# where X/W strip offsets are wrong
#sbs.gemorigin_xyz =  -0.00403358  0.000297287       4.1218
#sbs.gemangles_xyz =     0.117299    -0.264845    -0.814373

#sbs.gemorigin_xyz =   0.00329963  0.000298602      4.12189
#sbs.gemangles_xyz =     0.117061    -0.283118    -0.814324

sbs.gemorigin_xyz =  -0.00102233   0.00070928      4.12068
sbs.gemangles_xyz =     0.121055    -0.308798    -0.799353


sbs.gemangles_xyz = 0 0 0 

# the following lines enable use of the "polarimeter mode" analysis:
sbs.polarimetermode = 1
# z of detector center line looks like it's more or less at the downstream edge of the analyzer, implying the downstream edge of the analyzer will
# about 0.428 m downstream of the X/W layer 0. Subtract half the analyzer thickness and we get that the center of the analyzer is about 39.7 cm
# downstream of the first GEM layer, which seems in the right ballpark.
sbs.z0analyzer = 0.397

# GEN-RP optics model (4th-order) from g4sbs for 100% SBS field, calculated using
# Bogdan's field map:

# second-order optics with scale factor 1.057
sbs.optics_order = 2
sbs.optics_parameters = 
 -0.00044566945  6.5794268e-05 -0.00050874088     0.46312392  0 0 0 0 0
     0.35147022  1.8289173e-05   0.0023374836   0.0026402989  1 0 0 0 0
    0.012753323   -0.025033924    0.058945784  -0.0094791369  2 0 0 0 0
   0.0019919597   -0.010659333       1.043118   -0.041997392  0 1 0 0 0
     0.24637582    0.078812488    -0.24130309    0.041567783  1 1 0 0 0
    0.036264951    0.015637797    -0.08890566    -0.13110589  0 2 0 0 0
    -0.44839794   0.0029572076   -0.014487956   -0.022950615  0 0 1 0 0
   -0.038798016      0.1656326    -0.42691761    0.049163794  1 0 1 0 0
    -0.29532316    -0.31008076      1.0498694    0.014030392  0 1 1 0 0
   0.0033026169     -0.2009635      0.5588758   -0.030796712  0 0 2 0 0
  -0.0018016593      1.0170495      -4.181738     0.04235215  0 0 0 1 0
     -1.0686055    -0.14155181     0.40591013    0.079302969  1 0 0 1 0
    -0.27693794    -0.18266314      1.0769671      1.0440456  0 1 0 1 0
      1.3446902     0.61831487     -1.9383789    -0.26592363  0 0 1 1 0
     0.65035381     0.33050366     -2.2399797     -2.0467629  0 0 0 2 0
 -2.4785282e-15  1.2040152e-16   -6.55716e-16  2.9832804e-14  0 0 0 0 1
  1.2961777e-15  7.7302691e-16 -7.3717027e-15   4.982366e-15  1 0 0 0 1
 -2.3116124e-16  -5.355771e-17  3.2690256e-16  -5.065963e-16  0 1 0 0 1
  2.8452203e-16 -1.9194794e-16 -9.6605917e-16 -4.6428789e-16  0 0 1 0 1
  2.3776963e-16 -5.3153082e-17 -4.1940517e-16  9.7393625e-16  0 0 0 1 1
  9.4869193e-16 -2.8608487e-16  3.7195019e-16 -8.2823428e-15  0 0 0 0 2


#sbs.optics_order = 4

# below are new 4th-order parameters with scale factor 1.057:
#sbs.optics_parameters =
#   0.0013061456  0.00019433265    0.003131495     0.44778505  0 0 0 0 0
#     0.33813397   0.0023172076   -0.032718719     0.15814665  1 0 0 0 0
#    0.039681586   -0.059253712     0.22018771    -0.55380158  2 0 0 0 0
#   -0.017187651    0.076242297    -0.28908648     0.75711205  3 0 0 0 0
#     0.04787871   -0.060765342     0.20524286    -0.42251308  4 0 0 0 0
#   -0.026737205    0.075215007     0.78455671    0.049185998  0 1 0 0 0
#     0.50139197    -0.49927334      1.1791796     -1.6638034  1 1 0 0 0
#    -0.54563491     0.66021355    -0.82497017      7.6455201  2 1 0 0 0
#     0.36083816     0.95211807     -2.8458517     -9.6655746  3 1 0 0 0
#     0.80112383     0.54689094      -2.061314     -9.5348332  0 2 0 0 0
#      -1.294844     -3.1612447      12.030005      56.625898  1 2 0 0 0
#    -0.18317736       17.87391     -40.848506     -70.167745  2 2 0 0 0
#      1.6085793      14.418783     -42.073551      21.869281  0 3 0 0 0
#     -17.170316      19.435499     -26.759291      34.604751  1 3 0 0 0
#     -10.148381      20.075731     -41.990122      120.35698  0 4 0 0 0
#    -0.38715968   0.0019822957     0.12516915    -0.69216047  0 0 1 0 0
#    -0.35905008     0.30295676     -1.4345894      4.4796157  1 0 1 0 0
#     0.44895195    -0.53461951      2.3914523     -9.2899271  2 0 1 0 0
#    -0.44641444     0.85845329     -3.0565735      6.3101494  3 0 1 0 0
#     -1.1516303      2.1319391     -5.4696479      3.9583095  0 1 1 0 0
#       3.979004     -7.1596364      12.536272     -40.523355  1 1 1 0 0
#     -4.0028616     -3.7094766       16.26083      89.444813  2 1 1 0 0
#      10.161115       18.10625     -74.806984     -169.06593  0 2 1 0 0
#     -2.1785838     -89.145611      235.63611      489.97897  1 2 1 0 0
#      26.526464     -16.985601      34.430805      152.17411  0 3 1 0 0
#     0.77880207    -0.25359209      2.2446072     -9.4578756  0 0 2 0 0
#     -2.5467126      1.3112779     -7.9853979      37.584498  1 0 2 0 0
#      2.4792947      -2.860221      11.605763     -37.096766  2 0 2 0 0
#     -6.9547071       16.56735     -35.385913          49.34  0 1 2 0 0
#       13.94802     -6.0970647     -15.028327     -236.49971  1 1 2 0 0
#      20.193953      132.13603     -452.20202     -692.13747  0 2 2 0 0
#      4.1044577    -0.50205337      8.6604408     -52.386406  0 0 3 0 0
#     -7.1989623      4.0657486     -21.852968      98.366378  1 0 3 0 0
#     -15.764503      23.769023     -24.939964      185.74188  0 1 3 0 0
#      7.9327418     -1.2254708      16.222924     -100.84006  0 0 4 0 0
#     0.10273063     0.67542778     -3.1851942    -0.33520691  0 0 0 1 0
#     -2.0322675      2.1049951       -4.99171      7.0245382  1 0 0 1 0
#      2.2523969     -2.2730004      2.3505954     -33.136368  2 0 0 1 0
#     -1.8619835     -4.3502567      12.738479      44.480056  3 0 0 1 0
#     -6.8455773     -5.5312326      19.340888      80.717006  0 1 0 1 0
#      12.333149      34.817731     -117.38614     -482.05597  1 1 0 1 0
#       1.627797     -162.46958      367.96537      611.44172  2 1 0 1 0
#     -9.7176385     -158.29204      495.36598     -341.06458  0 2 0 1 0
#      193.07476     -281.77847      439.08432     -135.60844  1 2 0 1 0
#      103.07742     -159.34353       238.1922     -1414.7348  0 3 0 1 0
#      4.6028564     -9.0964105      23.129049      -16.87718  0 0 1 1 0
#      -16.29809      27.028754     -44.240308      175.39478  1 0 1 1 0
#      18.679232      18.906672     -75.586519     -386.58881  2 0 1 1 0
#     -90.804145      -178.5193       685.7783      1448.3134  0 1 1 1 0
#      20.656243      836.63716     -2155.0234     -4249.7954  1 1 1 1 0
#     -225.66724      437.15416     -861.83954     -3058.0116  0 2 1 1 0
#      28.092717      -65.66554      133.09658     -213.14782  0 0 2 1 0
#     -62.607417      15.181773      89.654434      1016.0396  1 0 2 1 0
#     -185.60472     -1266.1698      4145.1717      6025.3749  0 1 2 1 0
#      67.830148     -91.288073      73.805129     -800.20723  0 0 3 1 0
#      14.529117         13.562     -45.095275     -171.38629  0 0 0 2 0
#     -27.936348     -90.914664      284.31424      1025.1305  1 0 0 2 0
#     -6.3584398      369.28654     -833.24153     -1325.1331  2 0 0 2 0
#     0.64287381      562.65326     -1907.5031      1690.5163  0 1 0 2 0
#     -725.83117      1381.4252     -2439.0501     -668.95652  1 1 0 2 0
#     -296.28097      116.60021      478.49251      5961.0284  0 2 0 2 0
#      197.66211      431.20677     -1570.5377     -3103.5092  0 0 1 2 0
#     -36.488317     -1960.7647       4969.925      9176.4987  1 0 1 2 0
#      551.08212     -2888.9841      5937.2828      17383.659  0 1 1 2 0
#      402.51395      3002.9748     -9507.5036     -13069.649  0 0 2 2 0
#      49.433841     -642.19851       2394.337     -2685.2331  0 0 0 3 0
#       910.5629     -2259.9772      4458.2483      2547.2486  1 0 0 3 0
#       27.93711      1479.9715     -4191.1321     -10847.871  0 1 0 3 0
#     -285.82285      5627.3533     -12170.569     -30156.777  0 0 1 3 0
#       633.0139     -2722.2272      4598.3695      7618.2265  0 0 0 4 0
#  3.7993509e-14 -6.5570891e-14  2.0072877e-13 -1.8442047e-13  0 0 0 0 1
#  4.1902371e-14  1.4219275e-13 -4.1900406e-13 -6.2647441e-13  1 0 0 0 1
#  8.0762441e-14 -3.0963097e-13  9.6503909e-13  4.1867035e-13  2 0 0 0 1
#  -5.388134e-14  9.2451915e-14 -2.5584093e-13  -1.996078e-13  3 0 0 0 1
# -1.5995144e-13  3.1955523e-13  -5.871782e-13 -4.4564576e-12  0 1 0 0 1
#  7.6580772e-14 -2.9577638e-13  7.8928008e-13  2.7556476e-12  1 1 0 0 1
#  2.1645867e-14 -6.8212371e-13  1.8201335e-12   2.664149e-12  2 1 0 0 1
#  8.6849169e-15 -9.3072557e-14  1.6574656e-13  4.9953035e-13  0 2 0 0 1
# -3.1299154e-13  8.7825983e-13 -3.1947482e-12   2.221623e-12  1 2 0 0 1
#  8.2111452e-14 -3.7937122e-13  5.0458826e-13  8.6992392e-13  0 3 0 0 1
#  6.0435449e-14 -3.2343646e-13  9.1301108e-13  6.9428397e-13  0 0 1 0 1
# -1.0649993e-13   5.680441e-13 -1.7087675e-12 -9.5377051e-13  1 0 1 0 1
#  2.5741026e-13 -3.3349803e-13  1.1639109e-12 -8.9142077e-13  2 0 1 0 1
# -3.4552876e-17 -9.2831346e-15 -2.5846978e-13  1.6185232e-12  0 1 1 0 1
# -2.0983191e-13  1.4895216e-12 -2.9244758e-12 -8.9985833e-12  1 1 1 0 1
# -1.1093617e-14  2.0998055e-13 -5.7225921e-13 -2.0252523e-12  0 2 1 0 1
#  2.0011109e-13 -8.8408585e-13  2.9809164e-12  1.6186053e-13  0 0 2 0 1
#  1.5734236e-13 -7.2669589e-13  2.3146485e-12  4.5241185e-13  1 0 2 0 1
#  3.1049846e-13 -1.6337412e-12  3.9023019e-12  4.6944545e-12  0 1 2 0 1
# -2.3468321e-13  8.5202263e-13 -1.8040673e-12 -2.8436571e-12  0 0 3 0 1
# -1.1735785e-14  5.7863541e-14 -3.1345844e-13 -5.3972597e-13  0 0 0 1 1
#  7.0998448e-14 -8.9615653e-15  1.3858395e-13  3.4229957e-13  1 0 0 1 1
# -2.6433578e-13 -6.1368454e-13  1.8691895e-12  3.3983688e-12  2 0 0 1 1
#  1.1781269e-14  3.2576305e-13 -7.0652888e-13 -1.2826832e-12  0 1 0 1 1
#  1.1226267e-13 -1.3856575e-12   2.939682e-12  6.1327327e-12  1 1 0 1 1
#  2.6647417e-13 -7.9411055e-13  2.2755843e-12  1.0857974e-12  0 2 0 1 1
#  1.9813105e-13  -4.114571e-13   6.044004e-13  1.9672376e-12  0 0 1 1 1
# -5.4978621e-14  9.5348377e-13  -2.609755e-12 -2.1590728e-12  1 0 1 1 1
# -1.9338879e-13  6.1482247e-13 -9.6694231e-13 -5.6172921e-13  0 1 1 1 1
# -2.2273174e-13  3.8215558e-13 -5.7808419e-13   1.274949e-13  0 0 2 1 1
#  2.0724847e-13 -7.4451932e-13  1.1295993e-12   2.025796e-12  0 0 0 2 1
#  3.5904656e-13  6.4951525e-14 -7.0678891e-13 -2.5691968e-12  1 0 0 2 1
#  2.6273588e-13  -1.232748e-14 -3.3058934e-13 -1.6242185e-12  0 1 0 2 1
#  1.9646031e-13 -8.1116313e-13  1.6702084e-12  3.7400293e-12  0 0 1 2 1
#  2.2796409e-13 -1.3779185e-12   2.585573e-12  7.3954846e-12  0 0 0 3 1
# -7.8257384e-14 -8.1436368e-14  3.2972934e-13  6.7258849e-13  0 0 0 0 2
#  1.3278473e-13  2.0292091e-13 -4.6383331e-14 -3.7468581e-12  1 0 0 0 2
# -1.2561611e-13 -3.0231519e-13  1.3134087e-12 -6.7926774e-14  2 0 0 0 2
# -8.1200645e-14   4.635528e-13 -8.3644098e-13 -7.1745389e-13  0 1 0 0 2
#  1.2614638e-13 -7.4816753e-13  1.6763107e-12  3.6258248e-12  1 1 0 0 2
#  1.3848372e-13 -6.0816754e-13  3.7964875e-13  4.5887864e-12  0 2 0 0 2
# -2.5122748e-13 -8.9788628e-13  2.6950193e-12   5.118963e-12  0 0 1 0 2
# -8.3868315e-14   8.707509e-13 -2.1098878e-12 -2.9734541e-12  1 0 1 0 2
# -1.8729824e-13  3.1683814e-13 -5.1602266e-13  6.0043566e-13  0 1 1 0 2
# -2.1706155e-13  1.1139318e-12 -2.1656016e-12 -4.8914113e-12  0 0 2 0 2
#  3.1037792e-13 -1.0975363e-12  2.0444501e-12  1.6351255e-12  0 0 0 1 2
#   1.398453e-13  5.5670437e-13 -1.4964753e-12 -3.4246954e-12  1 0 0 1 2
# -1.2144636e-13  6.0379501e-13 -1.3529653e-12   6.373881e-13  0 1 0 1 2
#  1.3830484e-13  8.3601972e-14 -8.6952377e-13 -1.0054192e-12  0 0 1 1 2
# -1.5971569e-13  2.2997931e-13 -3.8628756e-14  8.3679449e-14  0 0 0 2 2
# -1.4206116e-13  1.6596106e-13 -1.2795705e-13 -2.5217358e-13  0 0 0 0 3
# -1.7095924e-14  3.8903014e-13 -6.3480456e-13 -1.7647685e-12  1 0 0 0 3
# -1.1784414e-14  4.3254518e-14 -9.7115905e-14 -2.0022174e-13  0 1 0 0 3
#   -9.10754e-14 -2.2802713e-13    6.62433e-13  2.4568044e-12  0 0 1 0 3
#  2.6194412e-14 -2.4804023e-13  5.1596306e-13  1.1820286e-12  0 0 0 1 3
# -1.9007843e-15  4.6014395e-15 -6.5022592e-15 -2.7180612e-15  0 0 0 0 4

# below are better 4th-order optics for scale factor 1
#sbs.optics_order = 4
#sbs.optics_parameters = 
# -0.00025928813  0.00072392311   0.0029092608     0.42581362  0 0 0 0 0
#     0.35273886  -0.0080882309   -0.040347203     0.14310588  1 0 0 0 0
#   -0.018988551   -0.016514942     0.33106277    -0.54285186  2 0 0 0 0
#     0.12450565    0.066728887    -0.65777517     0.97159845  3 0 0 0 0
#    -0.10162934    -0.12460034     0.53133359    -0.73145041  4 0 0 0 0
#   0.0094881825   0.0064801984     0.92502311    0.037121408  0 1 0 0 0
#     0.14181775    -0.14140637     0.90573895    -0.76892312  1 1 0 0 0
#     0.74689457     0.59644815     -2.8792636      3.0502552  2 1 0 0 0
#     -1.0398122     -0.5131884       2.254689     -2.9213411  3 1 0 0 0
#   0.0080168851    -0.10070872     0.43103167     -2.6496199  0 2 0 0 0
#     0.59254448      1.3517117     -5.4050512      7.5846105  1 2 0 0 0
#     -1.2818495     -1.9763445      7.6482123     -8.4491066  2 2 0 0 0
#      -1.614293      8.5932438     -26.075349     -24.985726  0 3 0 0 0
#     -6.6211359      -19.57916      55.177725      32.949763  1 3 0 0 0
#     -4.0104688     0.11073014     -29.890168      31.724256  0 4 0 0 0
#    -0.45177807    0.018800596      0.1525316    -0.58896696  0 0 1 0 0
#     0.10503211    0.071591444     -2.1622771      4.2007184  1 0 1 0 0
#    -0.82002504    -0.20005966      5.8330423     -10.179743  2 0 1 0 0
#      1.3321234      1.3741561     -7.2198745      9.5889998  3 0 1 0 0
#    0.042309665     0.70479126      -3.775574      2.4668803  0 1 1 0 0
#     -4.3228626     -4.0737318        21.3658     -19.468484  1 1 1 0 0
#      9.5169691      4.2859084     -23.199611      35.113354  2 1 1 0 0
#     -1.2363827     -1.5029778       8.839699     -32.091804  0 2 1 0 0
#      6.5852258      4.3807389     -35.249314      50.775756  1 2 1 0 0
#      -3.873758      20.133505     -86.592243     -219.62584  0 3 1 0 0
#    -0.18827605   -0.092766462      3.4493794      -8.300807  0 0 2 0 0
#      2.0131412     0.13939754     -18.963823      37.844945  1 0 2 0 0
#     -4.9755416     -3.6355225      31.182011     -47.168632  2 0 2 0 0
#      5.9176783       7.339046     -39.812853      30.458084  0 1 2 0 0
#     -28.047525     -13.110136       82.89961     -113.90797  1 1 2 0 0
#     -9.3372163      5.5264742      25.575502     -94.439842  0 2 2 0 0
#     -1.8794502   -0.079162043      20.561964     -48.757443  0 0 3 0 0
#      8.1978187      3.6628709     -63.381691      109.80224  1 0 3 0 0
#      26.038559      14.436867     -99.887159      120.24843  0 1 3 0 0
#     -5.5467802     -1.4698293      50.111975     -101.38725  0 0 4 0 0
#   -0.076416917      0.9304669     -3.7199227    -0.48212741  0 0 0 1 0
#    -0.37949502     0.80045877     -4.2586629      4.7509247  1 0 0 1 0
#     -3.2230899     -2.6276454      12.687915     -16.781115  2 0 0 1 0
#      3.6720601      2.1409922     -11.107448      17.105211  3 0 0 1 0
#     0.19890467     0.62983519     -3.3274509      23.039702  0 1 0 1 0
#     -5.3412939     -7.8241967      40.223541      -73.63103  1 1 0 1 0
#      11.924763        10.8037     -58.509488      86.082424  2 1 0 1 0
#       22.21761     -88.830018      294.18176      296.78913  0 2 0 1 0
#      78.661484        208.427     -627.90898     -397.08063  1 2 0 1 0
#      52.082928      20.686505      322.54774     -286.32535  0 3 0 1 0
#     -1.1178031     -3.5476629      17.194084     -16.945357  0 0 1 1 0
#      19.784721      17.570064     -91.549083      111.31473  1 0 1 1 0
#     -35.978101     -20.033027      112.53856     -176.46724  2 0 1 1 0
#      14.635904      1.7188587     -61.277746      303.88591  0 1 1 1 0
#     -64.277495      1.9885969      252.39503     -530.38967  1 1 1 1 0
#      62.839452     -76.062081      770.84412      2618.4126  0 2 1 1 0
#     -30.620529     -29.636888      165.18522      -187.1446  0 0 2 1 0
#      111.03294       63.87709     -389.78944      583.43653  1 0 2 1 0
#      98.503924     -117.34432     -119.85082      970.83609  0 1 2 1 0
#     -112.82418     -67.085216      453.97086      -650.3164  0 0 3 1 0
#    -0.51159431     -1.0695504      5.9193406     -48.785564  0 0 0 2 0
#      10.157348      10.798033     -73.040024      163.69527  1 0 0 2 0
#     -24.911453     -14.825946      110.72213      -194.5014  2 0 0 2 0
#     -100.78911      293.09331     -1091.0255     -1161.4784  0 1 0 2 0
#     -308.22198     -697.28264      2335.0968      1554.2399  1 1 0 2 0
#     -206.05555     -145.48625     -1032.6714      804.30175  0 2 0 2 0
#     -33.577755      15.290979      92.983624     -672.21962  0 0 1 2 0
#      133.65033     -64.390012     -411.81557      1210.8439  1 0 1 2 0
#     -319.89655      -472.4128      -1779.527     -10354.835  0 1 1 2 0
#     -218.95677      361.56371      21.292113     -2226.3668  0 0 2 2 0
#      153.34214     -295.30713      1319.6806      1501.6756  0 0 0 3 0
#       389.2158      701.72489     -2809.3804     -1982.5358  1 0 0 3 0
#      157.66871      123.37031      537.54574     -1016.2797  0 1 0 3 0
#      561.75557       1869.713       293.7022      13559.922  0 0 1 3 0
#      311.30525      492.96593      1376.1584      1252.8634  0 0 0 4 0
#  8.6674011e-14  2.1452243e-12 -5.5169649e-12  9.0069688e-13  0 0 0 0 1
# -6.3711467e-13 -9.3862663e-12  2.4367806e-11 -3.9840372e-12  1 0 0 0 1
#  8.3552299e-13  1.1268916e-11 -2.9573815e-11   3.128001e-12  2 0 0 0 1
# -1.2563006e-12 -2.1639804e-11  5.6360591e-11 -8.0983013e-12  3 0 0 0 1
#  1.7850548e-13   1.444455e-12 -3.8044004e-12  5.5168018e-13  0 1 0 0 1
# -8.9203439e-13 -1.4334387e-11  3.7453565e-11 -4.9799788e-12  1 1 0 0 1
# -3.3826863e-12 -5.4262317e-11  1.4225058e-10  -1.711889e-11  2 1 0 0 1
#  2.1816128e-13  -1.942498e-12  5.5945867e-12  1.0301758e-12  0 2 0 0 1
# -1.3788102e-13 -4.7040237e-12   1.288184e-11  8.9071782e-13  1 2 0 0 1
#  2.8523325e-12   4.211638e-11  -1.097209e-10  1.6717926e-11  0 3 0 0 1
#   2.970246e-12  4.3635563e-11 -1.1345873e-10  1.6521187e-11  0 0 1 0 1
# -5.3305473e-12 -7.7749643e-11  2.0160396e-10 -3.1086075e-11  1 0 1 0 1
#  5.5814792e-12  8.7000958e-11 -2.2728067e-10  2.9471661e-11  2 0 1 0 1
#  1.4641084e-13  3.7477619e-12 -1.0110252e-11 -9.6046715e-13  0 1 1 0 1
# -4.3240286e-15  3.5340851e-12 -1.0942574e-11 -4.1592414e-12  1 1 1 0 1
# -5.4557942e-13 -7.8057492e-12  2.0227405e-11 -2.6879874e-12  0 2 1 0 1
#    1.05585e-11  1.5790633e-10 -4.1017425e-10  5.7957108e-11  0 0 2 0 1
#  -2.842071e-12  -3.946581e-11  1.0181607e-10 -1.8640388e-11  1 0 2 0 1
#  1.2239583e-12  2.0981079e-11 -5.3978063e-11   8.935024e-12  0 1 2 0 1
# -8.4136341e-12 -1.2793647e-10  3.3375128e-10 -4.5802362e-11  0 0 3 0 1
# -1.9962103e-13  1.9367351e-12 -5.0258732e-12 -6.0523885e-13  0 0 0 1 1
#  7.0326936e-13  1.1566274e-11 -3.0736414e-11  3.5982116e-12  1 0 0 1 1
#  4.2567491e-12   6.783602e-11 -1.7776896e-10   2.130335e-11  2 0 0 1 1
#  1.6072264e-12  2.7116857e-11 -7.1439917e-11  8.1856104e-12  0 1 0 1 1
#  3.3782448e-14 -6.9017948e-13  3.1281352e-12  8.0342518e-13  1 1 0 1 1
#  4.2877934e-12  6.0389366e-11 -1.5602797e-10  2.3798767e-11  0 2 0 1 1
#   2.429505e-12  3.9084065e-11 -1.0231368e-10  1.2718109e-11  0 0 1 1 1
#  3.4010923e-12  5.5405871e-11 -1.4525316e-10  1.7028252e-11  1 0 1 1 1
# -5.5843273e-14  -5.001769e-12  1.4746427e-11  1.4325607e-12  0 1 1 1 1
#  8.3225744e-13  1.7417051e-11 -4.7169915e-11  2.2043575e-12  0 0 2 1 1
#  5.3655313e-13  6.0941512e-12 -1.5839805e-11   1.589651e-12  0 0 0 2 1
#   -1.39261e-13 -2.7357092e-13 -5.1158397e-13 -3.5298743e-12  1 0 0 2 1
#  1.8954857e-12  2.7643983e-11 -7.2151527e-11   7.964849e-12  0 1 0 2 1
#  1.3325756e-13  -5.712979e-13  4.1336372e-12  4.3412047e-12  0 0 1 2 1
#  7.1654238e-13  9.9986908e-12 -2.6871989e-11  1.7509429e-12  0 0 0 3 1
#  9.4046763e-13  1.3422398e-11  -3.476689e-11  4.1297456e-12  0 0 0 0 2
# -2.7027521e-12 -4.3733987e-11  1.1406447e-10 -1.6585332e-11  1 0 0 0 2
# -5.8541159e-13  -2.451966e-12   5.249889e-12 -4.8045698e-12  2 0 0 0 2
# -5.4866836e-13 -3.8397411e-12  9.5060003e-12 -2.8800705e-12  0 1 0 0 2
# -5.5590184e-12 -8.8068295e-11  2.3050339e-10 -3.1126303e-11  1 1 0 0 2
# -1.5374185e-12 -2.8557974e-11  7.7313759e-11 -2.9570535e-12  0 2 0 0 2
#  5.5569543e-12  8.6378554e-11 -2.2564651e-10   2.917865e-11  0 0 1 0 2
# -4.5930789e-13 -6.3122406e-12  1.6913079e-11 -1.5192157e-12  1 0 1 0 2
#  -1.732374e-12 -2.8886689e-11  7.6375929e-11 -8.8374297e-12  0 1 1 0 2
# -1.0490064e-12 -1.4063159e-11  3.5920151e-11  -5.551572e-12  0 0 2 0 2
# -1.1261337e-13 -5.5405933e-13  2.6503233e-13 -3.3090426e-12  0 0 0 1 2
# -1.4515527e-12 -2.3206678e-11  6.0195055e-11 -8.2330941e-12  1 0 0 1 2
# -5.1547087e-13 -7.5329714e-12  1.9193902e-11 -4.1472332e-12  0 1 0 1 2
# -5.6107539e-13 -7.8284719e-12  2.0377222e-11 -3.1723753e-12  0 0 1 1 2
# -1.2114865e-13 -1.8779675e-12    4.62152e-12 -9.5602226e-13  0 0 0 2 2
#  4.2894156e-16  1.3124538e-13  4.7342179e-13  1.1561295e-13  0 0 0 0 3
#  2.5415135e-15  5.0164051e-13 -1.5739994e-12 -1.8250821e-12  1 0 0 0 3
# -1.0345864e-13  1.0954787e-13  -1.123559e-12 -2.2441195e-12  0 1 0 0 3
#  7.8434506e-14   4.485715e-13 -4.8773457e-13  1.1187661e-12  0 0 1 0 3
#  4.7029667e-14 -1.4979166e-13 -8.8892829e-13 -1.8173774e-12  0 0 0 1 3
# -8.2666118e-15 -3.2165799e-14 -1.4193116e-14 -7.2366611e-13  0 0 0 0 4





# these constraints should be okay to start with for "straight through" tracking with all SBS GEMs treated
# together as a single tracking unit

sbs.backconstraintwidth_x = 0.3
sbs.backconstraintwidth_y = 0.26
sbs.backconstraint_x0 = -0.031
sbs.backconstraint_y0 = 0.0


sbs.usedynamicconstraint = 1
# theta = xbcp * slope + th0
sbs.dynamicthslope = 0.111
sbs.dynamicth0 = -0.051

sbs.dynamicphslope = 0.0947
sbs.dynamicph0 = 0.002

sbs.usedynamicconstraint = 1

sbs.polarimetermode = 0

sbs.frontconstraintwidth_x = 0.45
sbs.frontconstraintwidth_y = 0.15
sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = -0.012

------------[ 2024-04-18 23:51:00 ] # zero-field running, single foil. Target is front constraint:
sbs.dynamicth0 = 0.0
# open these up a bit until we figure out how to center them for zero-field data:
sbs.frontconstraintwidth_x = 0.13
sbs.frontconstraintwidth_y = 0.13

sbs.frontconstraint_x0 = 0.0164 
sbs.frontconstraint_y0 = 0.0


------------[ 2024-04-19 3:30:00 ] # back to full-field running
sbs.dynamicth0 = -0.06845

------------[ 2024-04-19 07:30:00 ] # analyzer installed

sbs.polarimetermode = 1

# the constraints to be used in "polarimeter mode" are below. Uncomment after the analyzer is installed

sbs.usedynamicconstraint = 0

sbs.backconstraintwidth_x = 0.006 0.3
sbs.backconstraintwidth_y = 0.006 0.26
sbs.backconstraint_x0 = 0.0 0.033
sbs.backconstraint_y0 = 0.0 0.0

# front constraint width should accommodate polar scattering angles up to
# about 18 degrees: 0.4 m * tan ( 18 deg ) ~= 0.13
sbs.frontconstraintwidth_x = 0.13 1.2
sbs.frontconstraintwidth_y = 0.13 0.3
sbs.frontconstraint_x0 = 0.0 0.0
sbs.frontconstraint_y0 = 0.0 0.0

----------[ 2024-05-15 16:00:00 ] # reduce sbs field setting to 70% of maximum

sbs.optics_order = 2

# new 4th-order optics for SBS 70% from g4sbs:
sbs.optics_parameters = 
-0.00037994301 -8.7224462e-05  0.00039198619     0.30507057  0 0 0 0 0
     0.35355175 -0.00068282719  0.00042214902    0.016411108  1 0 0 0 0
   0.0055787772   -0.024547906    0.065074306   -0.029975878  2 0 0 0 0
 -0.00023168979   -0.017126045      1.0664813   -0.056551997  0 1 0 0 0
     0.24823548     0.16362282    -0.57043755     0.17760195  1 1 0 0 0
    0.055226251     -0.1172221     0.53703751     0.60003635  0 2 0 0 0
    -0.45264014  0.00044755396   0.0051655066   -0.066463799  0 0 1 0 0
  -0.0016190805     0.15846078    -0.44789879     0.20301566  1 0 1 0 0
    -0.32663978    -0.68316196       2.452237    -0.38839627  0 1 1 0 0
   -0.034479702     -0.1955771     0.60672064    -0.32964641  0 0 2 0 0
  0.00087031185      1.0615179     -4.3423533     0.10297058  0 0 0 1 0
     -1.0315613    -0.56787469      2.0219423    -0.47910364  1 0 0 1 0
    -0.45292708     0.94101086     -4.2895418     -5.5620833  0 1 0 1 0
      1.3376506      2.4402697     -8.7395134       1.243135  0 0 1 1 0
     0.91244714     -2.0233656      9.0221837      12.721717  0 0 0 2 0
  3.1444523e-14 -1.6074834e-12  7.1956404e-12 -3.0290179e-13  0 0 0 0 1
  5.1493766e-14  1.9922388e-13 -9.1387833e-13 -8.1492549e-15  1 0 0 0 1
 -2.0781505e-17  1.3441747e-14 -5.3607027e-14  1.5751562e-15  0 1 0 0 1
  9.4695572e-15  1.3646665e-13 -6.1050445e-13  1.4055353e-14  0 0 1 0 1
  -4.511502e-16  7.4789263e-15 -1.7152007e-14  3.0419936e-16  0 0 0 1 1
  1.4586952e-15 -3.8415385e-15 -2.0766093e-15 -9.4585066e-15  0 0 0 0 2


