-------[ 2021-01-01 00:00:00 ]


## track constraint widths:
sbs.frontconstraintwidth_x = 0.75 # m
sbs.frontconstraintwidth_y = 0.25 # m
sbs.backconstraintwidth_x = 0.28 # m
sbs.backconstraintwidth_y = 0.23 # m
sbs.backconstraint_x0 = 0.5 
sbs.backconstraint_y0 = -0.0042
sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = 0.0

sbs.gemorigin_xyz = 0.0 0.0 4.825

#the optics matrix elements below are for SBS 100% field setting (using approximation of uniform field in the magnet gap):
sbs.precon_flag = 0

sbs.optics_order = 2

# SBS 50% field for GEN configuration:
sbs.optics_parameters =
 -4.7492373e-05 -3.0076826e-05  9.7658771e-05      0.2368548  0 0 0 0 0
     0.29406313  -0.0022728891   0.0074340655   0.0016531116  1 0 0 0 0
 -0.00079535663   0.0034732323  -0.0087346869   0.0070309193  2 0 0 0 0
   0.0013825575  -0.0060321865      1.0274256  -0.0051965265  0 1 0 0 0
     0.11963484    0.026855614    -0.12483853    0.018499472  1 1 0 0 0
  -0.0054083514     0.05759505    -0.19453195    0.059565112  0 2 0 0 0
     -0.4195945    0.010480438   -0.035369236  -0.0098816328  0 0 1 0 0
    0.010900296   -0.030027456     0.08358603   -0.014998565  1 0 1 0 0
    -0.14793145    -0.12402843     0.58081927    -0.08525447  0 1 1 0 0
   -0.034567836     0.06354853    -0.19160053    0.044249134  0 0 2 0 0
  -0.0055976765      1.0273391     -4.9440968     0.01696626  0 0 0 1 0
    -0.58097842    -0.11795225     0.51742424   -0.061321435  1 0 0 1 0
    0.053480872     -0.4504135      1.5539073     -0.4541342  0 1 0 1 0
      0.7499874     0.61478662     -2.6543871     0.27831895  0 0 1 1 0
    -0.12665448     0.91037838      -3.197888     0.93866798  0 0 0 2 0
  5.3330367e-15  2.8911089e-14 -1.0816528e-13 -1.9194737e-14  0 0 0 0 1
 -1.9401887e-15 -4.1937965e-15  1.7721383e-14 -2.1850874e-14  1 0 0 0 1
  1.0722579e-15  7.7445726e-16 -3.7688536e-15  2.6770205e-15  0 1 0 0 1
  7.5106687e-16 -1.1950822e-15  9.8391957e-15 -1.2347115e-15  0 0 1 0 1
  2.3646997e-16 -1.1667667e-16 -1.9264282e-16 -5.6474397e-16  0 0 0 1 1
  3.2742694e-16  -1.094353e-15  3.2631097e-15  -1.518398e-15  0 0 0 0 2

# SBS 30% field for GEN configuration:
sbs.optics_parameters = 
 -3.9793076e-05 -0.00021958306  0.00077632912     0.14539652  0 0 0 0 0
     0.29362296 -0.00040166393   0.0022051916   0.0073454874  1 0 0 0 0
  0.00054633448  0.00089942297   0.0023068647  -0.0054110009  2 0 0 0 0
 -0.00025350036  -0.0047118895      1.0244949 -0.00045551193  0 1 0 0 0
     0.12749638    0.032892231    -0.16313876  -0.0014421081  1 1 0 0 0
   0.0033025146    0.051561798    -0.20332191    0.051639733  0 2 0 0 0
    -0.41796005   0.0020721824   -0.013641984   -0.035952964  0 0 1 0 0
   0.0031019379  -0.0094061969  -0.0049763021     0.07858849  1 0 1 0 0
    -0.18241576    -0.16207846     0.81647553    0.026106389  0 1 1 0 0
   -0.024779755    0.019820787   -0.014255702    -0.17153092  0 0 2 0 0
  0.00090686829      1.0195593     -4.9255022   -0.002373647  0 0 0 1 0
    -0.61557426    -0.13473266     0.65092994    0.021849731  1 0 0 1 0
   -0.024288308    -0.40223151      1.6266844    -0.41666754  0 1 0 1 0
     0.90072772     0.71085083     -3.4025141    -0.18276902  0 0 1 1 0
    0.035062243     0.80870167     -3.3436212     0.80097896  0 0 0 2 0
 -1.3192296e-14  3.4895072e-15 -2.3328211e-14 -2.3491218e-14  0 0 0 0 1
 -1.3821117e-15 -3.4791546e-15  1.1404732e-14  6.1396022e-15  1 0 0 0 1
  2.1336319e-15  2.9729321e-16 -1.0681814e-15 -2.6072193e-15  0 1 0 0 1
  1.5618654e-15   -9.90699e-16  4.0941642e-15 -4.1829097e-16  0 0 1 0 1
  5.1697134e-16  1.2310463e-16 -8.6493022e-16 -5.9245231e-16  0 0 0 1 1
  4.5944684e-16  6.6524697e-17  2.8352903e-16 -9.1314535e-16  0 0 0 0 2

--------[ 2022-10-14 00:00:00 ] # start GEN-2 kinematics: here we mainly run with SBS at full field:


# SBS 100% field for GEN configuration... BdL ~= 1.58 T*m
sbs.optics_parameters =
  -0.0003513201  5.3757169e-05 -0.00039405534      0.4746328  0 0 0 0 0
     0.29431137 -6.4786094e-05   0.0007172775    0.001446896  1 0 0 0 0
  0.00046508419 -0.00040215314   0.0014340977   0.0076777109  2 0 0 0 0
  0.00039824129  -0.0014993516       1.005907 -0.00018809634  0 1 0 0 0
     0.12583597   0.0093546922   -0.038057985   0.0032724021  1 1 0 0 0
   0.0050509875   0.0047190471   0.0093248106    0.038019853  0 2 0 0 0
    -0.42294892  0.00081299015  -0.0056427729  -0.0091939953  0 0 1 0 0
   0.0063149389   0.0020891526  -0.0060265101   0.0030162675  1 0 1 0 0
    -0.17285935   -0.040700375     0.16129629   -0.012315548  0 1 1 0 0
   -0.039082297    -0.00128007   -0.001709668    0.045100546  0 0 2 0 0
  -0.0040627701      1.0170874     -4.8926068   -0.002228922  0 0 0 1 0
    -0.59575772   -0.049546309     0.21091191  -0.0056070761  1 0 0 1 0
   -0.025402411   -0.037685667   -0.035912365    -0.21797913  0 1 0 1 0
     0.81142079     0.33997576     -1.3319419    0.029927015  0 0 1 1 0
    0.025431516    0.067446723    0.028925304     0.33807591  0 0 0 2 0
 -7.2130705e-16   2.395829e-15 -6.7074436e-16  2.8011489e-14  0 0 0 0 1
 -8.0344008e-16 -8.4204583e-15  4.6113261e-14 -7.7975922e-15  1 0 0 0 1
 -2.1963046e-16 -7.8606246e-16  2.4646817e-15 -1.0909688e-14  0 1 0 0 1
 -3.7147256e-16 -8.8648438e-16  6.0221692e-15  1.3425275e-14  0 0 1 0 1
 -3.3139766e-16 -5.5967834e-17 -3.8427815e-16 -9.6972098e-15  0 0 0 1 1
 -2.4792623e-16  2.7226815e-16 -1.3185506e-15 -8.6599971e-16  0 0 0 0 2


-------[ 2023-03-08 00:00:00 ] New Constraints for GEN4 kinematic

sbs.frontconstraintwidth_x = 1.0 # m
sbs.frontconstraintwidth_y = 0.3 # m

------[ 2023-09-01 00:00:00 ] # reverting to old constraint centering: 

sbs.frontconstraintwidth_x = 1.0 # m
sbs.frontconstraintwidth_y = 0.3 # m

sbs.backconstraintwidth_x = 0.22 # m
sbs.backconstraintwidth_y = 0.21 # m
sbs.backconstraint_x0 = 0.50286
sbs.backconstraint_y0 = 0.11554
sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = 0.0

-------[ 2023-11-01 00:00:00 ] # start pion-A_LL

sbs.backconstraint_x0 = 0.24
sbs.backconstraint_y0 = 0.0
sbs.backconstraintwidth_x = 0.25
sbs.backconstraintwidth_y = 0.22

-------[ 2024-04-01 00:00:00 ] # start GEN-RP

# according to the version of g4sbs used to generate this optics model, the first GEM plane is at 4.105 m
# from the target
sbs.optics_origin = 0.0 0.0 4.105 

# according to anecdotal, low-accuracy tape measurements from Sean and Anu and Bhashita et al,
# the GEN-RP GEM first layer was about 81 cm downstream of the back end of the SBS magnet iron in GEN,
# and in GEN-RP the first XW layer is about 5 cm downstream of THAT.
# so we estimate that the actual first GEN-RP GEM layer in Hall A is about 4.33 m from the target
# this is probably not a great guess! But anyway,
# for an initial guess at the ACTUAL position of the SBS GEMs in the hall, we go with:
#sbs.gemorigin_xyz = 0.0 0.0 4.329
#sbs.gemtheta = 0.0
#sbs.gemphi = 0.0

# AJRP 4/17/2024: Let's update these numbers from the survey report: according to the survey, the CE polarimeter fiducial point is
# 2.64 mm to beam left, 6.35 mm high, and 4.6 mm DOWNSTREAM of the "ideal" position which I assume is (0,0,4.760 m).
# assuming X/W layer 0,1 readout boards are symmetrically offset wrt the railing mount and 5.7 cm apart, then
# the first layer is essentially 0.428 m upstream of the fiducial point, which puts it at about 4.324 m 
# But wait! according to the survey, the magnet itself is also about 6.2 mm high and about 1.7 mm to beam left and about 1.2 mm upstream of ideal! so in fact,
# relative to the ideal optics coordinate system, the detector active area center is something like the following (to within a mm or so, not accounting for
# any mispointing or anything like that.
#sbs.gemorigin_xyz = 0.0 0.0 4.324
#sbs.gemtheta = 0.0
#sbs.gemphi = 0.0

# new GEM origin coordinates based on straight-through alignment, run 121:
# angles are given in degrees and positions in meters
#sbs.gemorigin_xyz =  -0.00644053   0.00102861      4.10979
#sbs.gemangles_xyz =     0.132415    -0.222712    -0.803711

# even better alignment after cutting the pathological region of track X
# where X/W strip offsets are wrong
#sbs.gemorigin_xyz =  -0.00403358  0.000297287       4.1218
#sbs.gemangles_xyz =     0.117299    -0.264845    -0.814373

#sbs.gemorigin_xyz =   0.00329963  0.000298602      4.12189
#sbs.gemangles_xyz =     0.117061    -0.283118    -0.814324

sbs.gemorigin_xyz =  -0.00102233   0.00070928      4.12068
sbs.gemangles_xyz =     0.121055    -0.308798    -0.799353


#sbs.gemangles_xyz = 0.12 0 -0.8 

# the following lines enable use of the "polarimeter mode" analysis:
sbs.polarimetermode = 1
# z of detector center line looks like it's more or less at the downstream edge of the analyzer, implying the downstream edge of the analyzer will
# about 0.428 m downstream of the X/W layer 0. Subtract half the analyzer thickness and we get that the center of the analyzer is about 39.7 cm
# downstream of the first GEM layer, which seems in the right ballpark.
sbs.z0analyzer = 0.397

# GEN-RP optics model (4th-order) from g4sbs for 100% SBS field, calculated using
# Bogdan's field map:

# second-order optics with scale factor 1.057
#sbs.optics_order = 2
#sbs.optics_parameters = 
# -0.00044566945  6.5794268e-05 -0.00050874088     0.46312392  0 0 0 0 0
#     0.35147022  1.8289173e-05   0.0023374836   0.0026402989  1 0 0 0 0
#    0.012753323   -0.025033924    0.058945784  -0.0094791369  2 0 0 0 0
#   0.0019919597   -0.010659333       1.043118   -0.041997392  0 1 0 0 0
#     0.24637582    0.078812488    -0.24130309    0.041567783  1 1 0 0 0
#    0.036264951    0.015637797    -0.08890566    -0.13110589  0 2 0 0 0
#    -0.44839794   0.0029572076   -0.014487956   -0.022950615  0 0 1 0 0
#   -0.038798016      0.1656326    -0.42691761    0.049163794  1 0 1 0 0
#    -0.29532316    -0.31008076      1.0498694    0.014030392  0 1 1 0 0
#   0.0033026169     -0.2009635      0.5588758   -0.030796712  0 0 2 0 0
#  -0.0018016593      1.0170495      -4.181738     0.04235215  0 0 0 1 0
#     -1.0686055    -0.14155181     0.40591013    0.079302969  1 0 0 1 0
#    -0.27693794    -0.18266314      1.0769671      1.0440456  0 1 0 1 0
#      1.3446902     0.61831487     -1.9383789    -0.26592363  0 0 1 1 0
#     0.65035381     0.33050366     -2.2399797     -2.0467629  0 0 0 2 0
# -2.4785282e-15  1.2040152e-16   -6.55716e-16  2.9832804e-14  0 0 0 0 1
#  1.2961777e-15  7.7302691e-16 -7.3717027e-15   4.982366e-15  1 0 0 0 1
# -2.3116124e-16  -5.355771e-17  3.2690256e-16  -5.065963e-16  0 1 0 0 1
#  2.8452203e-16 -1.9194794e-16 -9.6605917e-16 -4.6428789e-16  0 0 1 0 1
#  2.3776963e-16 -5.3153082e-17 -4.1940517e-16  9.7393625e-16  0 0 0 1 1
#  9.4869193e-16 -2.8608487e-16  3.7195019e-16 -8.2823428e-15  0 0 0 0 2

# scale factor 1.0657:
#sbs.optics_order = 4
#sbs.optics_parameters = 
#   0.0010177005  0.00024964849 -0.00031097503     0.45454816  0 0 0 0 0
#      0.3391492  -0.0049526251    0.010559986     0.12351254  1 0 0 0 0
#    0.046091804   -0.012017009    0.064368498     -0.4403885  2 0 0 0 0
#   -0.027695959   0.0099891219    -0.15317505     0.68211512  3 0 0 0 0
#    0.019745488   -0.078817125     0.24684153    -0.54554357  4 0 0 0 0
#  -0.0081825216   -0.025867113      1.0825375   -0.030775232  0 1 0 0 0
#     0.30914815     0.13090314    -0.37267959    -0.11611572  1 1 0 0 0
#   -0.036739767    -0.29817031     0.64395094     0.51439528  2 1 0 0 0
#   -0.014343899     0.26817023    -0.35219525    -0.62801878  3 1 0 0 0
#    0.023202964  -0.0066644483     0.25128292     -1.0551202  0 2 0 0 0
#     0.57299507     0.37454596     -2.7387595      5.5858217  1 2 0 0 0
#    -0.80448498     -1.0347856      3.1741826     -9.6062607  2 2 0 0 0
#       1.192227      6.4394595     -22.661387     0.66314112  0 3 0 0 0
#     -6.4523473     -3.3281207      14.195557      11.002638  1 3 0 0 0
#     -2.5737521     -2.4221441      4.1795523      48.624359  0 4 0 0 0
#    -0.40050454    0.019668726   -0.020374622    -0.48892425  0 0 1 0 0
#    -0.31869473    0.025841896    -0.32735255      3.1689086  1 0 1 0 0
#     0.51869525     0.15805913     0.35368936     -7.1779534  2 0 1 0 0
#     -0.2753925     0.69998804     -2.8470524      6.2118787  3 0 1 0 0
#    -0.53988538    -0.44835869      1.2748857    0.075821307  0 1 1 0 0
#     0.22765604      1.8850146     -4.7432255    -0.82076902  1 1 1 0 0
#     0.27737673     -3.3874808      6.3422424      8.6642903  2 1 1 0 0
#     -1.1866548     -0.7715963      6.2377672     -13.529308  0 2 1 0 0
#      5.8626145   -0.099210545     -7.6834026      53.416234  1 2 1 0 0
#      17.777632      13.637188     -47.506663     -22.351305  0 3 1 0 0
#     0.56002809     0.11037968     0.39192512     -5.8908252  0 0 2 0 0
#     -2.1669423     -1.0271779     0.20899356      24.799432  1 0 2 0 0
#      2.0888574     -1.0428373      6.6173306     -28.823198  2 0 2 0 0
#    -0.99955113     -3.0388136      7.9210973      -2.424297  0 1 2 0 0
#     -1.4930969      12.097552     -28.423229     -11.650359  1 1 2 0 0
#     -9.2895799      4.1680731    -0.88927817     -50.279842  0 2 2 0 0
#      2.8005463      1.7917946     -1.0688039     -29.542976  0 0 3 0 0
#     -5.6141763     -1.1444724     -4.4522178      61.774567  1 0 3 0 0
#     0.23341318     -13.715693      36.779773     -6.8470919  0 1 3 0 0
#      5.1710847      3.0544762      -1.086138     -51.891455  0 0 4 0 0
#    0.032079706      1.1083405     -4.4496717    0.027682064  0 0 0 1 0
#     -1.3044326    -0.56352346      1.6297942      0.4686618  1 0 0 1 0
#      0.3059865      1.4830926     -3.5705482     -3.2813702  2 0 0 1 0
#    -0.29249071    -0.81850291      1.0217073      6.9162263  3 0 0 1 0
#     -0.4282721    -0.14855057     -1.4862759      8.2901468  0 1 0 1 0
#     -1.9115285     -1.9964939      19.028193      -46.05086  1 1 0 1 0
#      2.8987854      8.5616114     -22.889604      82.321568  2 1 0 1 0
#      -11.36405     -77.840975      269.90387     -20.429192  0 2 0 1 0
#      72.487289      41.015629      -147.2979     -138.09366  1 2 0 1 0
#      23.167678      51.150139     -112.86162     -628.02386  0 3 0 1 0
#      2.3173376       1.948254     -5.6953753    -0.14215053  0 0 1 1 0
#      -2.267029     -9.8603115      27.648192      6.9308059  1 0 1 1 0
#      1.9192413      12.444003     -25.416593     -48.760728  2 0 1 1 0
#      1.0879082      1.4513052     -33.812957      110.08811  0 1 1 1 0
#     -25.808064      2.7630682      45.407132     -451.73127  1 1 1 1 0
#     -186.48696     -151.99771      475.35717      149.72862  0 2 1 1 0
#      6.2248928      16.879961     -49.823973      8.9444665  0 0 2 1 0
#      -4.857016       -48.1807      124.85153      66.850069  1 0 2 1 0
#      38.877481     -54.681569      90.051429      413.13662  0 1 2 1 0
#      10.150709      58.284195     -168.59666      20.905186  0 0 3 1 0
#      1.5022882      1.0217372       1.499968     -15.207546  0 0 0 2 0
#     -1.5276386     0.82503195     -30.939597      90.061219  1 0 0 2 0
#     0.63264171     -16.019485      38.586911     -164.34189  2 0 0 2 0
#      33.017792      311.87743     -1067.6798      126.91561  0 1 0 2 0
#     -274.47857     -157.23399      468.97589      544.15805  1 1 0 2 0
#     -69.365299      -373.7543      1029.0916      2890.2872  0 2 0 2 0
#       15.44296      12.472608      31.241934     -202.04511  0 0 1 2 0
#      7.8309262     -27.887941     -21.845915       885.3311  1 0 1 2 0
#      643.45471       519.7882     -1385.9566       -200.131  0 1 1 2 0
#      1.2806917      178.97175     -369.09485     -727.55631  0 0 2 2 0
#     -24.123873     -413.68411        1400.44     -205.42675  0 0 0 3 0
#      337.00374       190.3997     -435.28193      -773.6535  1 0 0 3 0
#      73.623476      1175.2115     -3830.0183     -5621.1943  0 1 0 3 0
#     -680.23604     -526.00883      1016.1465      50.135852  0 0 1 3 0
#      -16.28917      -1375.404      5035.2566       3793.016  0 0 0 4 0
#  5.5705426e-14 -1.6163269e-14 -4.1980998e-14  2.3939242e-13  0 0 0 0 1
#  7.9552485e-14  3.3793094e-13 -1.4300852e-12 -1.6426347e-12  1 0 0 0 1
# -1.0008026e-12  1.6216047e-12 -6.3052724e-12  9.4268144e-14  2 0 0 0 1
#  3.8663623e-14  1.0185602e-12 -3.4984732e-12 -5.5292783e-12  3 0 0 0 1
# -1.9248337e-13  1.7593366e-13 -8.7185744e-13  1.3383716e-12  0 1 0 0 1
#  6.3471057e-13 -5.7051847e-13  2.4923578e-12 -2.5642491e-12  1 1 0 0 1
# -5.0154665e-12  5.4290421e-12 -2.3174826e-11   1.981577e-11  2 1 0 0 1
#  -6.584765e-13 -9.2163126e-14 -3.4145946e-13  7.0490585e-12  0 2 0 0 1
# -1.8227662e-12  1.7462276e-12 -7.6103602e-12  7.1560606e-12  1 2 0 0 1
#  6.6543482e-14 -8.5315828e-14  5.0967453e-13  -7.233516e-13  0 3 0 0 1
# -3.5977759e-13  3.4141487e-13 -1.5690952e-12   2.244557e-12  0 0 1 0 1
#   4.322269e-13 -2.1024341e-13  1.2845949e-12 -6.4104354e-12  1 0 1 0 1
# -7.2704784e-13  2.6325079e-13 -1.5104753e-12  2.8602374e-12  2 0 1 0 1
# -8.7640342e-12  8.6322275e-12 -3.7626032e-11  3.7686852e-11  0 1 1 0 1
#  1.4629439e-12 -1.5644315e-12  6.7514511e-12 -7.6034547e-12  1 1 1 0 1
# -3.0403085e-14  1.0812031e-13 -4.6916127e-13 -2.9675566e-13  0 2 1 0 1
#  2.1612966e-13  2.3732711e-13  -5.465369e-13 -3.1097988e-12  0 0 2 0 1
# -7.0333087e-13  3.4972799e-13  -1.909002e-12  4.4706282e-12  1 0 2 0 1
#  3.1327345e-12 -2.9444068e-12  1.2926288e-11 -1.2412346e-11  0 1 2 0 1
# -5.3410559e-13  2.0730474e-15 -3.7291702e-13  2.2463711e-12  0 0 3 0 1
# -9.9847424e-13  7.1583971e-13 -3.3803115e-12  5.9358157e-12  0 0 0 1 1
#   1.247424e-14  2.7673549e-13 -1.0172086e-12 -9.5531451e-13  1 0 0 1 1
# -2.0134733e-12  2.0477448e-12 -8.8752164e-12   7.404162e-12  2 0 0 1 1
#  3.5153999e-12 -2.8999241e-12  1.3166371e-11 -1.7682997e-11  0 1 0 1 1
# -1.5704055e-12  1.6539072e-12 -7.2174814e-12  8.6493433e-12  1 1 0 1 1
#  1.2799485e-13 -9.7851195e-14   4.875157e-13 -2.2562113e-12  0 2 0 1 1
# -2.7989837e-12  2.9143887e-12  -1.247073e-11  1.1401115e-11  0 0 1 1 1
#  4.0435854e-13 -4.3505299e-13  1.9783009e-12 -5.4263362e-13  1 0 1 1 1
# -1.2920296e-13 -1.4494375e-13  3.5622091e-13 -1.4541177e-14  0 1 1 1 1
#  8.8224641e-13 -2.9852683e-13  1.6891311e-12 -6.0333967e-12  0 0 2 1 1
#  1.7551556e-12 -1.8583879e-12   7.993922e-12 -9.5503129e-12  0 0 0 2 1
# -1.0622019e-12  7.5265928e-13 -3.4602839e-12  3.8106682e-12  1 0 0 2 1
#  2.6442281e-14 -3.7658435e-13  1.3787404e-12  1.7111101e-13  0 1 0 2 1
#  1.1701544e-13  3.6213493e-13 -1.1557321e-12  -8.569712e-13  0 0 1 2 1
# -3.2862767e-14 -3.6822082e-14  1.2757998e-13 -1.5083316e-13  0 0 0 3 1
# -1.3104904e-13   2.544827e-13 -9.5042755e-13 -4.9321087e-13  0 0 0 0 2
#  1.6551226e-13  2.2565253e-13 -5.9873199e-13 -2.8550777e-12  1 0 0 0 2
# -1.0265468e-13 -1.8353704e-13  5.6251429e-13  9.6792675e-13  2 0 0 0 2
# -4.5678566e-12  4.2693826e-12 -1.8803763e-11  2.1683632e-11  0 1 0 0 2
#  3.1780546e-12 -3.0151209e-12  1.3294084e-11 -1.5778912e-11  1 1 0 0 2
# -3.1238604e-13  2.6460754e-13  -1.179659e-12  1.0947515e-12  0 2 0 0 2
# -6.3002311e-13  3.3714484e-14 -7.0455417e-13   3.267058e-12  0 0 1 0 2
# -1.4714565e-14 -1.0492571e-13  3.3994364e-13  4.1889713e-13  1 0 1 0 2
#  8.6482423e-13 -9.1169533e-13  3.9207027e-12 -3.0331645e-12  0 1 1 0 2
#  1.3793882e-13 -2.7606446e-13  1.0564248e-12 -8.1017204e-13  0 0 2 0 2
#  -1.327742e-12  1.0575197e-12 -4.7571301e-12  4.7679643e-12  0 0 0 1 2
#  7.1958903e-13 -8.9812474e-13  3.7434304e-12 -3.4382179e-12  1 0 0 1 2
#  5.2294862e-14  6.4527737e-14 -2.0249412e-13  4.5142152e-13  0 1 0 1 2
#  3.1109873e-13  8.2951115e-15  2.6990325e-13 -1.3336023e-12  0 0 1 1 2
#   3.538602e-13  6.1723289e-13 -1.8178964e-12 -1.3385882e-12  0 0 0 2 2
#  -1.186019e-13 -2.5043958e-13  7.6123485e-13  9.2798053e-13  0 0 0 0 3
#  8.7928911e-14  1.2008376e-13 -3.2166508e-13 -2.7959431e-13  1 0 0 0 3
#  5.9786478e-14  1.8939736e-13  -6.210738e-13 -4.4345054e-13  0 1 0 0 3
# -1.1507516e-14  1.4821672e-14 -5.2576202e-14 -9.7784521e-14  0 0 1 0 3
# -3.3121425e-14 -7.3784459e-14  2.2294523e-13  2.4354714e-13  0 0 0 1 3
#  2.1748405e-14  3.7176782e-14 -1.2975372e-13 -3.4784878e-16  0 0 0 0 4


## below are better 4th-order optics for scale factor 1
sbs.optics_order = 4
sbs.optics_parameters = 
 -0.00025928813  0.00072392311   0.0029092608     0.42581362  0 0 0 0 0
     0.35273886  -0.0080882309   -0.040347203     0.14310588  1 0 0 0 0
   -0.018988551   -0.016514942     0.33106277    -0.54285186  2 0 0 0 0
     0.12450565    0.066728887    -0.65777517     0.97159845  3 0 0 0 0
    -0.10162934    -0.12460034     0.53133359    -0.73145041  4 0 0 0 0
   0.0094881825   0.0064801984     0.92502311    0.037121408  0 1 0 0 0
     0.14181775    -0.14140637     0.90573895    -0.76892312  1 1 0 0 0
     0.74689457     0.59644815     -2.8792636      3.0502552  2 1 0 0 0
     -1.0398122     -0.5131884       2.254689     -2.9213411  3 1 0 0 0
   0.0080168851    -0.10070872     0.43103167     -2.6496199  0 2 0 0 0
     0.59254448      1.3517117     -5.4050512      7.5846105  1 2 0 0 0
     -1.2818495     -1.9763445      7.6482123     -8.4491066  2 2 0 0 0
      -1.614293      8.5932438     -26.075349     -24.985726  0 3 0 0 0
     -6.6211359      -19.57916      55.177725      32.949763  1 3 0 0 0
     -4.0104688     0.11073014     -29.890168      31.724256  0 4 0 0 0
    -0.45177807    0.018800596      0.1525316    -0.58896696  0 0 1 0 0
     0.10503211    0.071591444     -2.1622771      4.2007184  1 0 1 0 0
    -0.82002504    -0.20005966      5.8330423     -10.179743  2 0 1 0 0
      1.3321234      1.3741561     -7.2198745      9.5889998  3 0 1 0 0
    0.042309665     0.70479126      -3.775574      2.4668803  0 1 1 0 0
     -4.3228626     -4.0737318        21.3658     -19.468484  1 1 1 0 0
      9.5169691      4.2859084     -23.199611      35.113354  2 1 1 0 0
     -1.2363827     -1.5029778       8.839699     -32.091804  0 2 1 0 0
      6.5852258      4.3807389     -35.249314      50.775756  1 2 1 0 0
      -3.873758      20.133505     -86.592243     -219.62584  0 3 1 0 0
    -0.18827605   -0.092766462      3.4493794      -8.300807  0 0 2 0 0
      2.0131412     0.13939754     -18.963823      37.844945  1 0 2 0 0
     -4.9755416     -3.6355225      31.182011     -47.168632  2 0 2 0 0
      5.9176783       7.339046     -39.812853      30.458084  0 1 2 0 0
     -28.047525     -13.110136       82.89961     -113.90797  1 1 2 0 0
     -9.3372163      5.5264742      25.575502     -94.439842  0 2 2 0 0
     -1.8794502   -0.079162043      20.561964     -48.757443  0 0 3 0 0
      8.1978187      3.6628709     -63.381691      109.80224  1 0 3 0 0
      26.038559      14.436867     -99.887159      120.24843  0 1 3 0 0
     -5.5467802     -1.4698293      50.111975     -101.38725  0 0 4 0 0
   -0.076416917      0.9304669     -3.7199227    -0.48212741  0 0 0 1 0
    -0.37949502     0.80045877     -4.2586629      4.7509247  1 0 0 1 0
     -3.2230899     -2.6276454      12.687915     -16.781115  2 0 0 1 0
      3.6720601      2.1409922     -11.107448      17.105211  3 0 0 1 0
     0.19890467     0.62983519     -3.3274509      23.039702  0 1 0 1 0
     -5.3412939     -7.8241967      40.223541      -73.63103  1 1 0 1 0
      11.924763        10.8037     -58.509488      86.082424  2 1 0 1 0
       22.21761     -88.830018      294.18176      296.78913  0 2 0 1 0
      78.661484        208.427     -627.90898     -397.08063  1 2 0 1 0
      52.082928      20.686505      322.54774     -286.32535  0 3 0 1 0
     -1.1178031     -3.5476629      17.194084     -16.945357  0 0 1 1 0
      19.784721      17.570064     -91.549083      111.31473  1 0 1 1 0
     -35.978101     -20.033027      112.53856     -176.46724  2 0 1 1 0
      14.635904      1.7188587     -61.277746      303.88591  0 1 1 1 0
     -64.277495      1.9885969      252.39503     -530.38967  1 1 1 1 0
      62.839452     -76.062081      770.84412      2618.4126  0 2 1 1 0
     -30.620529     -29.636888      165.18522      -187.1446  0 0 2 1 0
      111.03294       63.87709     -389.78944      583.43653  1 0 2 1 0
      98.503924     -117.34432     -119.85082      970.83609  0 1 2 1 0
     -112.82418     -67.085216      453.97086      -650.3164  0 0 3 1 0
    -0.51159431     -1.0695504      5.9193406     -48.785564  0 0 0 2 0
      10.157348      10.798033     -73.040024      163.69527  1 0 0 2 0
     -24.911453     -14.825946      110.72213      -194.5014  2 0 0 2 0
     -100.78911      293.09331     -1091.0255     -1161.4784  0 1 0 2 0
     -308.22198     -697.28264      2335.0968      1554.2399  1 1 0 2 0
     -206.05555     -145.48625     -1032.6714      804.30175  0 2 0 2 0
     -33.577755      15.290979      92.983624     -672.21962  0 0 1 2 0
      133.65033     -64.390012     -411.81557      1210.8439  1 0 1 2 0
     -319.89655      -472.4128      -1779.527     -10354.835  0 1 1 2 0
     -218.95677      361.56371      21.292113     -2226.3668  0 0 2 2 0
      153.34214     -295.30713      1319.6806      1501.6756  0 0 0 3 0
       389.2158      701.72489     -2809.3804     -1982.5358  1 0 0 3 0
      157.66871      123.37031      537.54574     -1016.2797  0 1 0 3 0
      561.75557       1869.713       293.7022      13559.922  0 0 1 3 0
      311.30525      492.96593      1376.1584      1252.8634  0 0 0 4 0
  8.6674011e-14  2.1452243e-12 -5.5169649e-12  9.0069688e-13  0 0 0 0 1
 -6.3711467e-13 -9.3862663e-12  2.4367806e-11 -3.9840372e-12  1 0 0 0 1
  8.3552299e-13  1.1268916e-11 -2.9573815e-11   3.128001e-12  2 0 0 0 1
 -1.2563006e-12 -2.1639804e-11  5.6360591e-11 -8.0983013e-12  3 0 0 0 1
  1.7850548e-13   1.444455e-12 -3.8044004e-12  5.5168018e-13  0 1 0 0 1
 -8.9203439e-13 -1.4334387e-11  3.7453565e-11 -4.9799788e-12  1 1 0 0 1
 -3.3826863e-12 -5.4262317e-11  1.4225058e-10  -1.711889e-11  2 1 0 0 1
  2.1816128e-13  -1.942498e-12  5.5945867e-12  1.0301758e-12  0 2 0 0 1
 -1.3788102e-13 -4.7040237e-12   1.288184e-11  8.9071782e-13  1 2 0 0 1
  2.8523325e-12   4.211638e-11  -1.097209e-10  1.6717926e-11  0 3 0 0 1
   2.970246e-12  4.3635563e-11 -1.1345873e-10  1.6521187e-11  0 0 1 0 1
 -5.3305473e-12 -7.7749643e-11  2.0160396e-10 -3.1086075e-11  1 0 1 0 1
  5.5814792e-12  8.7000958e-11 -2.2728067e-10  2.9471661e-11  2 0 1 0 1
  1.4641084e-13  3.7477619e-12 -1.0110252e-11 -9.6046715e-13  0 1 1 0 1
 -4.3240286e-15  3.5340851e-12 -1.0942574e-11 -4.1592414e-12  1 1 1 0 1
 -5.4557942e-13 -7.8057492e-12  2.0227405e-11 -2.6879874e-12  0 2 1 0 1
    1.05585e-11  1.5790633e-10 -4.1017425e-10  5.7957108e-11  0 0 2 0 1
  -2.842071e-12  -3.946581e-11  1.0181607e-10 -1.8640388e-11  1 0 2 0 1
  1.2239583e-12  2.0981079e-11 -5.3978063e-11   8.935024e-12  0 1 2 0 1
 -8.4136341e-12 -1.2793647e-10  3.3375128e-10 -4.5802362e-11  0 0 3 0 1
 -1.9962103e-13  1.9367351e-12 -5.0258732e-12 -6.0523885e-13  0 0 0 1 1
  7.0326936e-13  1.1566274e-11 -3.0736414e-11  3.5982116e-12  1 0 0 1 1
  4.2567491e-12   6.783602e-11 -1.7776896e-10   2.130335e-11  2 0 0 1 1
  1.6072264e-12  2.7116857e-11 -7.1439917e-11  8.1856104e-12  0 1 0 1 1
  3.3782448e-14 -6.9017948e-13  3.1281352e-12  8.0342518e-13  1 1 0 1 1
  4.2877934e-12  6.0389366e-11 -1.5602797e-10  2.3798767e-11  0 2 0 1 1
   2.429505e-12  3.9084065e-11 -1.0231368e-10  1.2718109e-11  0 0 1 1 1
  3.4010923e-12  5.5405871e-11 -1.4525316e-10  1.7028252e-11  1 0 1 1 1
 -5.5843273e-14  -5.001769e-12  1.4746427e-11  1.4325607e-12  0 1 1 1 1
  8.3225744e-13  1.7417051e-11 -4.7169915e-11  2.2043575e-12  0 0 2 1 1
  5.3655313e-13  6.0941512e-12 -1.5839805e-11   1.589651e-12  0 0 0 2 1
   -1.39261e-13 -2.7357092e-13 -5.1158397e-13 -3.5298743e-12  1 0 0 2 1
  1.8954857e-12  2.7643983e-11 -7.2151527e-11   7.964849e-12  0 1 0 2 1
  1.3325756e-13  -5.712979e-13  4.1336372e-12  4.3412047e-12  0 0 1 2 1
  7.1654238e-13  9.9986908e-12 -2.6871989e-11  1.7509429e-12  0 0 0 3 1
  9.4046763e-13  1.3422398e-11  -3.476689e-11  4.1297456e-12  0 0 0 0 2
 -2.7027521e-12 -4.3733987e-11  1.1406447e-10 -1.6585332e-11  1 0 0 0 2
 -5.8541159e-13  -2.451966e-12   5.249889e-12 -4.8045698e-12  2 0 0 0 2
 -5.4866836e-13 -3.8397411e-12  9.5060003e-12 -2.8800705e-12  0 1 0 0 2
 -5.5590184e-12 -8.8068295e-11  2.3050339e-10 -3.1126303e-11  1 1 0 0 2
 -1.5374185e-12 -2.8557974e-11  7.7313759e-11 -2.9570535e-12  0 2 0 0 2
  5.5569543e-12  8.6378554e-11 -2.2564651e-10   2.917865e-11  0 0 1 0 2
 -4.5930789e-13 -6.3122406e-12  1.6913079e-11 -1.5192157e-12  1 0 1 0 2
  -1.732374e-12 -2.8886689e-11  7.6375929e-11 -8.8374297e-12  0 1 1 0 2
 -1.0490064e-12 -1.4063159e-11  3.5920151e-11  -5.551572e-12  0 0 2 0 2
 -1.1261337e-13 -5.5405933e-13  2.6503233e-13 -3.3090426e-12  0 0 0 1 2
 -1.4515527e-12 -2.3206678e-11  6.0195055e-11 -8.2330941e-12  1 0 0 1 2
 -5.1547087e-13 -7.5329714e-12  1.9193902e-11 -4.1472332e-12  0 1 0 1 2
 -5.6107539e-13 -7.8284719e-12  2.0377222e-11 -3.1723753e-12  0 0 1 1 2
 -1.2114865e-13 -1.8779675e-12    4.62152e-12 -9.5602226e-13  0 0 0 2 2
  4.2894156e-16  1.3124538e-13  4.7342179e-13  1.1561295e-13  0 0 0 0 3
  2.5415135e-15  5.0164051e-13 -1.5739994e-12 -1.8250821e-12  1 0 0 0 3
 -1.0345864e-13  1.0954787e-13  -1.123559e-12 -2.2441195e-12  0 1 0 0 3
  7.8434506e-14   4.485715e-13 -4.8773457e-13  1.1187661e-12  0 0 1 0 3
  4.7029667e-14 -1.4979166e-13 -8.8892829e-13 -1.8173774e-12  0 0 0 1 3
 -8.2666118e-15 -3.2165799e-14 -1.4193116e-14 -7.2366611e-13  0 0 0 0 4





# these constraints should be okay to start with for "straight through" tracking with all SBS GEMs treated
# together as a single tracking unit

sbs.backconstraintwidth_x = 0.3
sbs.backconstraintwidth_y = 0.26
sbs.backconstraint_x0 = -0.03
sbs.backconstraint_y0 = 0.0


sbs.usedynamicconstraint = 1
# theta = xbcp * slope + th0
sbs.dynamicthslope = 0.111
sbs.dynamicth0 = -0.051

sbs.dynamicphslope = 0.0947
sbs.dynamicph0 = 0.002

sbs.usedynamicconstraint = 1

sbs.polarimetermode = 0

sbs.frontconstraintwidth_x = 0.45
sbs.frontconstraintwidth_y = 0.15
sbs.frontconstraint_x0 = 0.2
sbs.frontconstraint_y0 = -0.012

------------[ 2024-04-18 23:51:00 ] # zero-field running, single foil. Target is front constraint:
sbs.dynamicth0 = 0.0
# open these up a bit until we figure out how to center them for zero-field data:
sbs.frontconstraintwidth_x = 0.13
sbs.frontconstraintwidth_y = 0.13

sbs.frontconstraint_x0 = 0.0164 
sbs.frontconstraint_y0 = 0.0


------------[ 2024-04-19 3:30:00 ] # back to full-field running
sbs.dynamicth0 = -0.051

sbs.frontconstraintwidth_x = 0.45
sbs.frontconstraintwidth_y = 0.15
sbs.frontconstraint_x0 = 0.2 
sbs.frontconstraint_y0 = -0.012


------------[ 2024-04-19 07:30:00 ] # analyzer installed

sbs.dynamicth0 = -0.06845

sbs.polarimetermode = 1

# the constraints to be used in "polarimeter mode" are below. Uncomment after the analyzer is installed

sbs.usedynamicconstraint = 0

sbs.backconstraintwidth_x = 0.006 0.3
sbs.backconstraintwidth_y = 0.006 0.26
sbs.backconstraint_x0 = 0.0 0.033
sbs.backconstraint_y0 = 0.0 0.0

# front constraint width should accommodate polar scattering angles up to
# about 18 degrees: 0.4 m * tan ( 18 deg ) ~= 0.13
sbs.frontconstraintwidth_x = 0.13 1.2
sbs.frontconstraintwidth_y = 0.13 0.3
sbs.frontconstraint_x0 = 0.0 0.0
sbs.frontconstraint_y0 = 0.0 0.0

----------[ 2024-05-15 16:00:00 ] # reduce sbs field setting to 70% of maximum

sbs.optics_order = 2

# new 4th-order optics for SBS 70% from g4sbs:
sbs.optics_parameters = 
-0.00037994301 -8.7224462e-05  0.00039198619     0.30507057  0 0 0 0 0
     0.35355175 -0.00068282719  0.00042214902    0.016411108  1 0 0 0 0
   0.0055787772   -0.024547906    0.065074306   -0.029975878  2 0 0 0 0
 -0.00023168979   -0.017126045      1.0664813   -0.056551997  0 1 0 0 0
     0.24823548     0.16362282    -0.57043755     0.17760195  1 1 0 0 0
    0.055226251     -0.1172221     0.53703751     0.60003635  0 2 0 0 0
    -0.45264014  0.00044755396   0.0051655066   -0.066463799  0 0 1 0 0
  -0.0016190805     0.15846078    -0.44789879     0.20301566  1 0 1 0 0
    -0.32663978    -0.68316196       2.452237    -0.38839627  0 1 1 0 0
   -0.034479702     -0.1955771     0.60672064    -0.32964641  0 0 2 0 0
  0.00087031185      1.0615179     -4.3423533     0.10297058  0 0 0 1 0
     -1.0315613    -0.56787469      2.0219423    -0.47910364  1 0 0 1 0
    -0.45292708     0.94101086     -4.2895418     -5.5620833  0 1 0 1 0
      1.3376506      2.4402697     -8.7395134       1.243135  0 0 1 1 0
     0.91244714     -2.0233656      9.0221837      12.721717  0 0 0 2 0
  3.1444523e-14 -1.6074834e-12  7.1956404e-12 -3.0290179e-13  0 0 0 0 1
  5.1493766e-14  1.9922388e-13 -9.1387833e-13 -8.1492549e-15  1 0 0 0 1
 -2.0781505e-17  1.3441747e-14 -5.3607027e-14  1.5751562e-15  0 1 0 0 1
  9.4695572e-15  1.3646665e-13 -6.1050445e-13  1.4055353e-14  0 0 1 0 1
  -4.511502e-16  7.4789263e-15 -1.7152007e-14  3.0419936e-16  0 0 0 1 1
  1.4586952e-15 -3.8415385e-15 -2.0766093e-15 -9.4585066e-15  0 0 0 0 2


